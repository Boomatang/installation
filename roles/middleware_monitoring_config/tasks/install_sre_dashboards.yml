---
- name: "Create {{ item }} from template"
  template:
    src: "{{ item }}.j2"
    dest: "/tmp/{{ item }}"
  with_items: "{{ sre_dashboards }}"

- name: Create dashboards from file
  shell: "oc apply -f /tmp/{{ item }} -n {{ monitoring_namespace }}"
  register: monitoring_resource_create
  failed_when: monitoring_resource_create.stderr != ''
  changed_when: monitoring_resource_create.rc == 0
  with_items: "{{ sre_dashboards }}"